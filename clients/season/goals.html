<!DOCTYPE html>
<html>
  <head>
    <title>Season</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#f6f4eb">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="season-logo.png" type="image/png">
    <link rel="apple-touch-icon" href="season-logo.png">
    <!-- Tailwind default CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="goals.css">
  </head>
  <body>
  <!-- BEGIN: Header container -->
  <div class="header-container">
    <!-- BEGIN: Season logo -->
    <svg enable-background="new 0 0 616.93 146.36" viewBox="0 0 616.93 146.36" xmlns="http://www.w3.org/2000/svg" height="22.5" width="94.5">
      <path fill="#101010" d="m20.76 31.49c0 11.29 7.38 18.24 25.62 29.53l15.85 9.77c14.98 9.12 24.32 18.89 24.32 34.96 0 25.19-20.63 40.17-41.69 40.17-22.37 0-37.13-15.63-43.86-36.05l18.02-10.42c7.6 28.01 20.63 37.35 32.14 37.35 12.38 0 21.28-7.38 21.28-19.98 0-11.51-3.47-18.67-20.41-29.1l-19.98-12.37c-14.11-8.69-25.62-18.02-25.62-35.18 0-21.28 18.24-39.74 47.34-39.74 11.07 0 21.5 1.52 28.45 4.56l-4.34 31.7c-10.22-18.45-23.9-26.05-37.14-26.05-12.16 0-19.98 7.82-19.98 20.85z">
      </path>
      <path fill="#101010" d="m178.85 108.57.43 34.53h-80.13c4.78-12.59 5.65-22.58 5.65-34.31v-72.53c0-11.73-.87-21.71-5.65-34.31h80.13l-.87 33.66c-10.21-17.59-20.19-27.14-49.94-27.14h-4.34c-.65 9.12-.87 18.46-.87 27.79v30.84h5.43c20.19 0 28.88-3.26 39.09-15.42v36.05c-10.21-10.86-18.89-14.33-39.09-14.33h-5.43v35.4c0 9.55.22 18.24 1.3 27.79h3.91c29.75 0 38-8.69 50.38-28.02z">
      </path>
      <path fill="#101010" d="m264.45 143.1c1.09-3.04 1.95-8.9 1.95-15.42 0-5.65-.65-11.73-2.17-17.16l-3.91-13.03h-41.26l-3.91 13.03c-1.74 5.65-2.61 12.16-2.61 17.81 0 6.08.87 11.51 2.82 14.77h-25.41c7.17-8.47 11.51-18.02 16.5-33.66l33.68-107.49h10.21l33.88 107.49c4.99 15.63 8.9 25.41 15.63 33.66zm-8.08-51.9-18.67-62.76-18.9 62.76z">
      </path>
      <path fill="#101010" d="m322.17 31.49c0 11.29 7.38 18.24 25.62 29.53l15.85 9.77c14.98 9.12 24.32 18.89 24.32 34.96 0 25.19-20.63 40.17-41.69 40.17-22.37 0-37.13-15.63-43.86-36.05l18.02-10.42c7.6 28.01 20.63 37.35 32.14 37.35 12.38 0 21.28-7.38 21.28-19.98 0-11.51-3.47-18.67-20.41-29.1l-19.98-12.38c-14.11-8.69-25.62-18.02-25.62-35.18 0-21.28 18.24-39.74 47.34-39.74 11.07 0 21.5 1.52 28.45 4.56l-4.34 31.7c-10.21-18.46-23.89-26.06-37.13-26.06-12.18.02-19.99 7.84-19.99 20.87z">
      </path>
      <path fill="#101010" d="m402.73 72.74c0-40.6 20.2-72.74 54.07-72.74 28.88 0 51.68 29.97 51.68 74.05 0 40.39-20.41 72.31-54.07 72.31-29.31 0-51.68-29.53-51.68-73.62zm85.56 10.64c0-50.16-16.5-75.13-36.7-75.13-19.98 0-28.66 20.63-28.66 54.72 0 43.86 14.33 75.13 36.48 75.13 19.97.01 28.88-22.79 28.88-54.72z">
      </path>
      <path fill="#101010" d="m617.93 1.95c-4.56 12.59-6.3 20.63-6.3 32.35v108.8h-13.25l-61.23-112.05v79.69c0 11.73 1.3 19.76 5.86 32.35h-20.19c4.34-12.59 6.08-20.63 6.08-32.35v-78.38c0-10.86-1.3-22.15-6.08-30.4h28.23c-1.3 2.39-1.95 4.78-1.95 6.95 0 3.91 1.74 7.82 4.56 13.03l49.73 90.77v-78.4c0-11.73-1.3-19.76-5.86-32.35h20.4z">
      </path>
    </svg>
    <!-- END: Season logo -->
    <div class="header-options">
      <div id="rd-chat-btn">
        <div class="green-dot"></div>
        <img src="img/alejandra.png" class="rd-image">
      </div>
      <div class="menu-item" id="ai-chat-btn">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="Reward-Stars-2--Streamline-Ultimate" height="24" width="24">
          <desc>Reward Stars 2 Streamline Icon: https://streamlinehq.com</desc>
          <defs></defs>
          <path d="M10.751 1.375c-0.025 6.281 3.029 9.844 10 10 -6.465 -0.025 -9.672 3.441 -10 10 -0.063 -6.187 -2.828 -10.009 -10 -10 6.416 -0.09 9.975 -3.187 10 -10Z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
          <path d="m19.012 1.375 0 4" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
          <path d="m17.012 3.375 4 0" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
          <path d="m21.25 18.625 0 4" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
          <path d="m19.25 20.625 4 0" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
        </svg>
      </div>
    </div>
  </div>
  <!-- END: Header container -->

    <!-- Appointment soon popups -->
    <div class="apt-soon--modal">
      <h2>Hey Michelle!</h2>
      <p>Your appointment with Alejandra is in 15 minutes.</p>
      <img class="rd-avatar" src="img/alejandra.png" alt="Alejandra Sanchez, RD" >
      <button class="cta-btn">Join now</button>
      <a href="#" class="no-thanks-btn">Just take me to Season for now</a>
    </div>
    <div class="apt-soon--short hidden">
      <div class="time">:15</div>
      <button class="cta-btn">Join now!</button>
    </div>
    <main>
      <div class="win-container">
        <h1>Welcome back, Michelle!</h1>
        <p>
          You've done <strong>5 straight days</strong> of exercise. 
          Consider skipping your run today and rest. But keep it up!
        </p>
        <div class="card-timeline" id="card-timeline">
          <div class="cards-container" id="cards-container">
            <div class="appointment-card hidden" data-appointment-date="2024-12-12" data-index="0">
              <div class="caption">Appointment</div>
              <div class="card-date">
                <div class="card-month">Dec</div>
                <div class="card-day">12</div>
              </div>
              <div class="card-blurb">
                <div class="card-blurb-text">First visit. Way to go!</div>
              </div>
              <button class="card-cta appt-report-btn">View Summary</button>
            </div>
        
            <div class="appointment-card left" data-appointment-date="2025-02-15" data-index="1">
              <div class="caption">Appointment</div>
              <div class="card-date">
                <div class="card-month">Feb</div>
                <div class="card-day">15</div>
              </div>
              <div class="card-blurb">
                <div class="card-blurb-text">Nice improvements!</div>
              </div>
              <button class="card-cta appt-report-btn">View Summary</button>
            </div>
        
            <div class="appointment-card center" data-appointment-date="2025-03-02" data-index="2">
              <div class="caption">Appointment</div>
              <div class="card-date">
                <div class="card-month">Mar</div>
                <div class="card-day">2</div>
              </div>
              <div class="card-blurb">
                <div class="card-blurb-text">You set new goals.</div>
              </div>
              <button class="card-cta appt-report-btn">View Summary</button>
            </div>
        
            <div class="appointment-card right" data-appointment-date="2025-04-12" data-index="3">
              <div class="caption">Appointment</div>
              <div class="card-date">
                <div class="card-month">Apr</div>
                <div class="card-day">12</div>
              </div>
              <div class="card-blurb">
                <div class="card-blurb-text">Nice work on your goals!</div>
              </div>
              <button class="card-cta appt-report-btn">View Summary</button>
            </div>
        
            <div class="appointment-card hidden" data-appointment-date="2025-05-21" data-index="4">
              <div class="caption">Appointment</div>
              <div class="card-date">
                <div class="card-month">May</div>
                <div class="card-day">21</div>
              </div>
              <div class="card-blurb">
                <div class="card-blurb-text">You ordered 10 meals.</div>
              </div>
              <button class="card-cta appt-report-btn">View Summary</button>
            </div>
        
            <div class="appointment-card hidden" data-appointment-date="2025-07-11" data-index="5">
              <div class="caption">Appointment</div>
              <div class="card-date">
                <div class="card-month">Jul</div>
                <div class="card-day">11</div>
              </div>
              <div class="card-blurb">
                <div class="card-blurb-text">Great eating improvements!</div>
              </div>
              <button class="card-cta appt-report-btn">View Summary</button>
            </div>
        
            <div class="appointment-card today center" data-appointment-date="2025-08-15" data-index="6">
              <div class="caption">Today</div>
              <div class="card-date">
                <div class="card-month">Aug</div>
                <div class="card-day">19</div>
              </div>
              <div class="card-blurb">
                <div class="card-blurb-text">Get ready for your visit.</div>
              </div>
              <button class="card-cta primary pre-visit-summary-btn">Prepare</button>
            </div>
        
            <div class="appointment-card hidden" data-appointment-date="2025-08-20" data-index="7">
              <div class="caption">Appointment</div>
              <div class="card-date">
                <div class="card-month">Aug</div>
                <div class="card-day">20</div>
              </div>
              <div class="card-blurb">
                <div class="card-blurb-text">Next appointment</div>
              </div>
              <button class="card-cta appt-report-btn">Re-schedule?</button>
            </div>
          </div>
        </div>
      </div>
    </main>
    <div class="bottom-panel">
      <div class="bottom-panel-header">
        How are your goals going?
      </div>
      <div class="goal-instructions">
        Rate your goal progress today. Scroll back to see how you did in the past.
      </div>
      <div class="goal-calendar-container">
        <div class="goal-calendar" id="unified-goal-calendar"></div>
      </div>
      <div class="bottom-panel-content">
        <div class="bottom-panel-grid" id="goals-container">
          <!-- Squares will be generated by JavaScript -->
        </div>
      </div>
    </div>
    <div class="footer-menu">
      <a href="#" class="footer-item">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <!-- Filled circle with checkmark -->
          <circle cx="12" cy="12" r="12" fill="currentColor"/>
          <path d="M9 12L11 14L15 10" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span>Goals</span>
      </a>
      <a href="#" class="footer-item">
        <svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg" class="lgIcon text-greyscale-70"><g fill="currentColor"><path d="m23 16.8604h-22c-.265216 0-.51957.1229-.707107.3417-.187536.2188-.292893.5155-.292893.8249s.105357.5531.292893.7719c.187537.2188.441891.3417.707107.3417l1.06.2198c.1638-.0003.32516.0463.46988.1358 0 .1488.26839 2.3858.36012 2.5442l.45.77c.18118.3209.4275.5847.7171.7679.28959.1832.61349.2801.9429.2821h14c.3294-.002.6533-.0989.9429-.2821s.5359-.447.7171-.7679l.45-.77c.0917-.1584.39-2.5404.3601-2.5442.1447-.0895.3061-.1361.4699-.1358l1.06-.2198c.2652 0 .5196-.1229.7071-.3417s.2929-.4625.2929-.7719-.1054-.6061-.2929-.8249-.4419-.3417-.7071-.3417z"></path><path d="m1.52632 15.1406h20.94738c.1396 0 .2734-.0518.3721-.1439.0987-.0922.1542-.2172.1542-.3476-.0011-2.0971-1-5.59897-3.1473-7.74631-1.3899-1.64733-3.3326-2.81037-5.5159-3.30214-.0368-.01056-.0709-.02828-.0999-.052-.029-.02371-.0524-.05289-.0685-.08561-.0156-.03418-.0237-.07096-.0237-.10813s.0081-.07395.0237-.10812c.139-.28032.2109-.58558.2105-.8945 0-.58657-.2495-1.14912-.6936-1.563883-.4442-.414768-1.0466-.647782-1.6748-.647782-.6281 0-1.2305.233014-1.6747.647782-.44417.414763-.69369.977313-.69369 1.563883-.00035.30892.0715.61418.21052.8945.01847.03343.0281.0705.0281.10812s-.00963.07469-.0281.10813c-.01726.03089-.0411.05817-.07007.08014-.02896.02198-.06243.03819-.09835.04764-2.18887.48837-4.13767 1.65124-5.53186 3.30093-2.62603 2.62603-3.152433 5.65585-3.15235 7.75735 0 .1304.05545.2554.15415.3476.09871.0921.23258.1439.37217.1439zm4.6421-7.74572c1.24771-1.20964 2.88579-2.00382 4.66318-2.26081.208-.02867.4196.02098.5884.13803.1688.11706.2809.29193.3116.48615s-.0225.39188-.1478.54949c-.1254.15761-.3127.26227-.5206.29094-1.42886.18879-2.75039.81446-3.75794 1.77917-.15072.14159-.35465.2227-.56842.22608-.10447-.00082-.20771-.02126-.30355-.0601s-.18234-.09529-.25434-.16598c-.13092-.13395-.20437-.30826-.20631-.48961-.00195-.18134.06776-.35699.19578-.49336z"></path></g></svg>
        <span>Meals</span>
      </a>
      <a href="#" class="footer-item">
        <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg" class="lgIcon text-greyscale-70"><path d="M10.3011 5.25285C10.3071 5.2065 10.2992 5.1594 10.2783 5.11759C10.2573 5.07579 10.2244 5.04117 10.1837 5.0182C8.95181 4.2458 6.11643 3.03343 0.748766 2.96499C0.683748 2.96157 0.618746 2.972 0.558065 2.9956C0.497385 3.0192 0.442411 3.05542 0.396788 3.10187C0.349072 3.14701 0.311363 3.20166 0.2861 3.26229C0.260837 3.32292 0.248583 3.38818 0.25013 3.45385V18.8627C0.248829 18.9264 0.26026 18.9897 0.283753 19.049C0.307246 19.1083 0.342329 19.1622 0.386946 19.2078C0.431563 19.2533 0.484817 19.2895 0.543588 19.3141C0.60236 19.3388 0.665466 19.3515 0.729211 19.3515C5.76445 19.42 8.55094 20.4759 9.90997 21.2385C9.94637 21.2621 9.98882 21.2746 10.0322 21.2746C10.0756 21.2746 10.118 21.2621 10.1544 21.2385C10.1891 21.2164 10.218 21.1861 10.2384 21.1503C10.2588 21.1146 10.2703 21.0744 10.2717 21.0332C10.2717 21.0332 10.2619 5.54616 10.3011 5.25285Z" fill="currentColor"></path><path d="M18.0933 16.3206C18.0917 16.4927 18.0304 16.659 17.9199 16.791C17.8093 16.9229 17.6563 17.0124 17.4871 17.0441C15.8987 17.3444 14.4353 18.1101 13.283 19.244C12.9087 19.6743 12.581 20.1429 12.3052 20.6421C12.2749 20.685 12.2587 20.7362 12.2587 20.7888C12.2587 20.8413 12.2749 20.8925 12.3052 20.9354C12.3472 20.9636 12.3965 20.9786 12.447 20.9786C12.4975 20.9786 12.5469 20.9636 12.5888 20.9354C15.3305 19.7691 18.2928 19.212 21.2709 19.3026C21.3346 19.3026 21.3978 19.2899 21.4565 19.2653C21.5153 19.2406 21.5685 19.2044 21.6132 19.1589C21.6578 19.1133 21.6929 19.0594 21.7164 19.0001C21.7399 18.9409 21.7513 18.8775 21.75 18.8138V3.45385C21.7515 3.38818 21.7393 3.32292 21.714 3.26229C21.6887 3.20166 21.651 3.14701 21.6033 3.10187C21.5577 3.05542 21.5027 3.0192 21.442 2.9956C21.3814 2.972 21.3164 2.96157 21.2513 2.96499C20.1661 2.96499 19.1884 3.04321 18.3182 3.1312C18.2594 3.14033 18.2057 3.1698 18.1664 3.21446C18.1271 3.25912 18.1047 3.31616 18.1031 3.37563L18.0933 16.3206Z" fill="currentColor"></path><path d="M16.451 15.783C16.5017 15.7682 16.5463 15.7373 16.5781 15.695C16.6098 15.6527 16.627 15.6012 16.627 15.5483V0.951013C16.6267 0.912052 16.6167 0.873776 16.5979 0.839637C16.5791 0.805498 16.5522 0.776572 16.5194 0.755469C16.4852 0.735732 16.4464 0.725342 16.407 0.725342C16.3675 0.725342 16.3287 0.735732 16.2945 0.755469C15.1542 1.13934 14.1219 1.78958 13.2832 2.65224C12.4716 3.44247 11.9309 4.46917 11.7384 5.58539V18.1393C11.7376 18.1884 11.7523 18.2366 11.7804 18.2769C11.8084 18.3173 11.8485 18.3478 11.8948 18.3641C11.9412 18.3822 11.9918 18.3863 12.0405 18.3759C12.0892 18.3655 12.1337 18.341 12.1686 18.3055C13.3344 17.0837 14.8171 16.2103 16.451 15.783Z" fill="currentColor"></path></svg>
        <span>Learn</span>
      </a>
      <a href="#" class="footer-item">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="12" cy="12" r="2" fill="currentColor"/>
          <circle cx="19" cy="12" r="2" fill="currentColor"/>
          <circle cx="5" cy="12" r="2" fill="currentColor"/>
        </svg>
        <span>More</span>
      </a>
    </div>
    <!-- Chat: Season Assistant -->
    <div class="popup" id="ai-chat">
      <div class="popup-content ai-chat">
        <div class="close" id="ai-chat-close-btn">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M6 6L18 18" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="chat-container">
          <div class="chat-header">
            <div class="ai-profile">
              <div class="ai-info">
                <h3>Season Assistant</h3>
              </div>
              <div class="chicklets">
              </div>
            </div>
          </div>
          <div class="chat-messages">
            <div class="message ai-message">
              <div class="message-content">
                <p>Hi Michelle! How are you feeling today? Any questions about your nutrition plan?</p>
              </div>
              <span class="message-time">2:30 PM</span>
            </div>
            <div class="message user-message">
              <div class="message-content">
                <p>Hi Jamie! I've been following the meal plan you gave me, but I'm still feeling tired in the afternoons. Any suggestions?</p>
              </div>
              <span class="message-time">2:32 PM</span>
            </div>
            <div class="message ai-message">
              <div class="message-content">
                <p>That's great that you're following the plan! Afternoon fatigue is common. Let's look at your protein intake at breakfast - are you getting at least 20g of protein in the morning?</p>
              </div>
              <span class="message-time">2:35 PM</span>
            </div>
            <div class="message user-message">
              <div class="message-content">
                <p>I'm not sure. I'll check my protein intake.</p>
              </div>
              <span class="message-time">2:45 PM</span>
            </div>
            <div class="message ai-message">
              <div class="message-content">
                <p>OK sounds good. Get back to me in a few days and we'll see how you're doing.</p>
              </div>
              <span class="message-time">3:10 PM</span>
            </div>
          </div>
          <div class="chat-input">
            <div class="input-container">
              <textarea placeholder="Ask Season anything..." class="message-input"></textarea>
              <button class="send-button">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M22 2L11 13" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Chat: RD -->
    <div class="popup" id="rd-chat">
      <div class="popup-content rd-chat">
        <div class="close" id="rd-chat-close-btn">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M6 6L18 18" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="chat-container">
          <div class="chat-header">
            <div class="rd-profile">
              <img src="img/alejandra.png" alt="Alejandra Sanchez, RD" class="rd-avatar">
              <div class="rd-info">
                <h3>Alejandra Sanchez, RD</h3>
                <span class="status">Online</span>
              </div>
            </div>
          </div>
          <div class="chat-messages">
            <div class="message rd-message">
              <div class="message-content">
                <p>Hi Michelle! How are you feeling today? Any questions about your nutrition plan?</p>
              </div>
              <span class="message-time">2:30 PM</span>
            </div>
            <div class="message user-message">
              <div class="message-content">
                <p>Hi Jamie! I've been following the meal plan you gave me, but I'm still feeling tired in the afternoons. Any suggestions?</p>
              </div>
              <span class="message-time">2:32 PM</span>
            </div>
            <div class="message rd-message">
              <div class="message-content">
                <p>That's great that you're following the plan! Afternoon fatigue is common. Let's look at your protein intake at breakfast - are you getting at least 20g of protein in the morning?</p>
              </div>
              <span class="message-time">2:35 PM</span>
            </div>
            <div class="message user-message">
              <div class="message-content">
                <p>I'm not sure. I'll check my protein intake.</p>
              </div>
              <span class="message-time">2:45 PM</span>
            </div>
            <div class="message rd-message">
              <div class="message-content">
                <p>OK sounds good. Get back to me in a few days and we'll see how you're doing.</p>
              </div>
              <span class="message-time">3:10 PM</span>
            </div>
          </div>
          <div class="chat-input">
            <div class="input-container">
              <textarea placeholder="Talk to Alejandra..." class="message-input"></textarea>
              <button class="send-button">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M22 2L11 13" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Appointment summary -->
    <div class="popup" id="appt-report">
      <div class="popup-content appt-report">
        <div class="close" id="appt-report-close-btn">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M6 6L18 18" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        
        <div class="appt-report-summary-content">
          <!-- Header -->
          <div class="summary-header" id="appt-report-header">4/13 - 5/21 Summary</div>
          
          <!-- Provider info -->
          <div class="summary-to">
            <img src="img/alejandra.png" alt="Alejandra Sanchez, RD" class="avatar">
            <div class="rd-info">
              <div class="rd-name">Alejandra Sanchez, RD</div>
              <div class="rd-title">Registered Dietitian</div>
            </div>
          </div>

          <!-- Tabs -->
          <div class="appt-report-tabs">
            <div class="tab-btn active" data-tab="shared">Activity</div>
            <div class="tab-btn" data-tab="pre-visit">Pre-visit</div>
            <div class="tab-btn" data-tab="post-visit">Post-visit</div>
          </div>

          <!-- Tab Content: What you shared -->
          <div class="tab-content active" id="shared-content">
            <div class="edit-form-content">
              <div class="edit-section">
                <h3>What you discussed with your RD</h3>
                <div class="edit-items">
                  <div class="edit-item excluded">
                    <div class="item-date">Apr 17</div>
                    <div class="item-text">Discussed afternoon energy crashes occurring daily around 2-3 PM and potential dietary causes.</div>
                  </div>
                  <div class="edit-item">
                    <div class="item-date">Apr 13</div>
                    <div class="item-text">Reviewed recent lab results showing elevated cholesterol (LDL: 145 mg/dL) and mild iron deficiency.</div>
                  </div>
                  <div class="edit-item">
                    <div class="item-date">Apr 10</div>
                    <div class="item-text">Talked about irregular sleep patterns and their impact on morning energy levels.</div>
                  </div>
                </div>
              </div>
              
              <div class="edit-section">
                <h3>What you shared with Season Assistant</h3>
                <div class="edit-items">
                  <div class="edit-item">
                    <div class="item-date">Apr 1</div>
                    <div class="item-text">Asked about meal prep strategies for busy weekdays and received customized suggestions.</div>
                  </div>
                  <div class="edit-item excluded">
                    <div class="item-date">Apr 1</div>
                    <div class="item-text">Discussed iron-rich food options and how to improve absorption with vitamin C pairing.</div>
                  </div>
                </div>
              </div>
              
              <div class="edit-section">
                <h3>Meals you ordered recently</h3>
                <div class="edit-items">
                  <div class="edit-item">
                    <div class="item-date">Apr 11</div>
                    <div class="item-text">Mediterranean Bowl with grilled chicken, quinoa, and tahini dressing (ordered 4 times).</div>
                  </div>
                  <div class="edit-item">
                    <div class="item-date">Mar 30</div>
                    <div class="item-text">Green Goddess Salad with salmon and avocado (ordered 3 times this month).</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Tab Content: Pre-visit -->
          <div class="tab-content" id="pre-visit-content">
            <div class="summary-content-style">
              <div class="content-section">
                <h3 class="section-title">Current Health Status</h3>
                <p class="section-text">Michelle has been experiencing consistent energy fluctuations throughout the day, particularly noticeable afternoon crashes around 2-3 PM. Recent lab work shows slightly elevated cholesterol and mild iron deficiency.</p>
                <ul class="section-list">
                  <li>Afternoon energy crashes (2-3 PM daily)</li>
                  <li>Elevated cholesterol levels (LDL: 145 mg/dL)</li>
                  <li>Mild iron deficiency (ferritin: 18 ng/mL)</li>
                  <li>Irregular sleep patterns affecting morning energy</li>
                </ul>
              </div>
              
              <div class="content-section">
                <h3 class="section-title">Dietary Patterns & Concerns</h3>
                <p class="section-text">Current eating habits include skipping breakfast 3-4 times per week, rushed lunches, and late dinners that are typically carb-heavy. Michelle tends to rely heavily on coffee for energy management.</p>
                <ul class="section-list">
                  <li>Frequent breakfast skipping (3-4x per week)</li>
                  <li>Rushed lunch breaks with processed foods</li>
                  <li>Late dinners (after 8 PM) with high carb content</li>
                  <li>Excessive caffeine consumption (4-5 cups daily)</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Tab Content: Post-visit -->
          <div class="tab-content" id="post-visit-content">
            <div class="summary-content-style">

              <div class="content-section">
                <h3 class="section-title">Assigned Goals</h3>
                <ul class="section-list">
                  <li>Say "no" to work treats</li>
                  <li>Drink 64oz of water a day</li>
                  <li>Exercise 15-20 min, 5 days per week</li>
                  <li>Avoid eating while watching TV</li>
                </ul>
              </div>
              <div class="content-section">
                <h3 class="section-title">Visit Summary</h3>
                <p class="section-text">Michelle met with Alejandra for a comprehensive follow-up consultation focusing on energy management and dietary optimization. Key progress was noted in several areas with new recommendations provided.</p>
              </div>
              <div class="content-section">
                <h3 class="section-title">Key Recommendations</h3>
                <ul class="section-list">
                  <li>Increase morning protein to 25g minimum within 2 hours of waking</li>
                  <li>Implement structured meal timing with no more than 4 hours between meals</li>
                  <li>Add iron supplement (18mg) with vitamin C source</li>
                  <li>Reduce caffeine intake gradually from 4-5 cups to 2 cups daily</li>
                </ul>
              </div>
              
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Pre-visit summary -->
    <div class="popup" id="pre-visit-summary">
      <div class="popup-content pre-visit-summary">
        <div class="close" id="pre-visit-summary-close-btn">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M6 6L18 18" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        
        <div class="pre-visit-summary-content">
          <!-- Header -->
          <div class="summary-header">Your pre-visit summary for 8/15</div>
          
          <!-- Provider info -->
          <div class="summary-to">
            <img src="img/alejandra.png" alt="Alejandra Sanchez, RD" class="avatar">
            <div class="rd-info">
              <div class="rd-name">Alejandra Sanchez, RD</div>
              <div class="rd-title">Registered Dietitian</div>
            </div>
          </div>

          <!-- Edit form -->
          <div class="edit-form" id="edit-form">
            <div class="edit-disclaimer">
              Review what you've done since last visit. Tap to
              hide things you don't want to share below. 
              Scroll to the bottom to share something else before your visit.
              <div class="bg-sparkle">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="Reward-Stars-2--Streamline-Ultimate" height="42" width="42">
                  <desc>Reward Stars 2 Streamline Icon: https://streamlinehq.com</desc>
                  <defs></defs>
                  <path d="M10.751 1.375c-0.025 6.281 3.029 9.844 10 10 -6.465 -0.025 -9.672 3.441 -10 10 -0.063 -6.187 -2.828 -10.009 -10 -10 6.416 -0.09 9.975 -3.187 10 -10Z" fill="none" stroke="rgba(132,197,230,0.7)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
                  <path d="m19.012 1.375 0 4" fill="none" stroke="rgba(132,197,230,0.7)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
                  <path d="m17.012 3.375 4 0" fill="none" stroke="rgba(132,197,230,0.7)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
                  <path d="m21.25 18.625 0 4" fill="none" stroke="rgba(132,197,230,0.7)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
                  <path d="m19.25 20.625 4 0" fill="none" stroke="rgba(132,197,230,0.7)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
                </svg>
              </div>
            </div>

            <div class="edit-section">
              <h3>What you discussed with your RD</h3>
              <div class="edit-items">
                <div class="edit-item" data-item-id="rd-1">
                  <div class="item-date">Aug 17</div>
                  <div class="item-toggle">
                    <svg viewBox="0 0 24 24" fill="#000000">
                      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                  </div>
                </div>
                <div class="edit-item" data-item-id="rd-2">
                  <div class="item-date">Aug 13</div>
                  <div class="item-text">Reviewed recent lab results showing elevated cholesterol (LDL: 145 mg/dL) and mild iron deficiency.</div>
                  <div class="item-toggle">
                    <svg viewBox="0 0 24 24" fill="#000000">
                      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                  </div>
                </div>
                <div class="edit-item" data-item-id="rd-3">
                  <div class="item-date">Aug 10</div>
                  <div class="item-text">Talked about irregular sleep patterns and their impact on morning energy levels.</div>
                  <div class="item-toggle">
                    <svg viewBox="0 0 24 24" fill="#000000">
                      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                  </div>
                </div>
                <div class="edit-item" data-item-id="rd-4">
                  <div class="item-date">Aug 4</div>
                  <div class="item-text">Established goals for consistent breakfast routine with 20g+ protein daily.</div>
                  <div class="item-toggle">
                    <svg viewBox="0 0 24 24" fill="#000000">
                      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="edit-section">
              <h3>What you shared with Season Assistant</h3>
              <div class="edit-items">
                <div class="edit-item" data-item-id="ai-1">
                  <div class="item-date">Aug 1</div>
                  <div class="item-text">Asked about meal prep strategies for busy weekdays and received customized suggestions.</div>
                  <div class="item-toggle">
                    <svg viewBox="0 0 24 24" fill="#000000">
                      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                  </div>
                </div>
                <div class="edit-item" data-item-id="ai-2">
                  <div class="item-date">Aug 1</div>
                  <div class="item-text">Discussed iron-rich food options and how to improve absorption with vitamin C pairing.</div>
                  <div class="item-toggle">
                    <svg viewBox="0 0 24 24" fill="#000000">
                      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                  </div>
                </div>
                <div class="edit-item" data-item-id="ai-3">
                  <div class="item-date">Aug 1</div>
                  <div class="item-text">Explored caffeine reduction strategies and healthy energy-boosting alternatives.</div>
                  <div class="item-toggle">
                    <svg viewBox="0 0 24 24">
                      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                  </div>
                </div>
                <div class="edit-item" data-item-id="ai-4">
                  <div class="item-date">Aug 14</div>
                  <div class="item-text">Got recommendations for timing evening meals earlier to improve sleep quality.</div>
                  <div class="item-toggle">
                    <svg viewBox="0 0 24 24" fill="#000000">
                      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                  </div>
                </div>
                <div class="edit-item" data-item-id="ai-5">
                  <div class="item-date">Aug 5</div>
                  <div class="item-text">Received a personalized hydration tracking plan to maintain 64+ oz daily water intake.</div>
                  <div class="item-toggle">
                    <svg viewBox="0 0 24 24" fill="#000000">
                      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="edit-section">
              <h3>Meals you ordered recently</h3>
              <div class="edit-items">
                <div class="edit-item" data-item-id="meal-1">
                  <div class="item-date">Aug 11</div>
                  <div class="item-text">Mediterranean Bowl with grilled chicken, quinoa, and tahini dressing (ordered 4 times).</div>
                  <div class="item-toggle">
                    <svg viewBox="0 0 24 24" fill="#000000">
                      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                  </div>
                </div>
                <div class="edit-item" data-item-id="meal-2">
                  <div class="item-date">Jul 30</div>
                  <div class="item-text">Green Goddess Salad with salmon and avocado (ordered 3 times this month).</div>
                  <div class="item-toggle">
                    <svg viewBox="0 0 24 24">
                      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                  </div>
                </div>
                <div class="edit-item" data-item-id="meal-3">
                  <div class="item-date">Jul 22</div>
                  <div class="item-text">Steel-cut oats breakfast bowl with berries and almond butter (morning favorite).</div>
                  <div class="item-toggle">
                    <svg viewBox="0 0 24 24">
                      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                  </div>
                </div>
                <div class="edit-item" data-item-id="meal-4">
                  <div class="item-date">Jul 15</div>
                  <div class="item-text">Lentil curry with brown rice and steamed vegetables (comfort meal choice).</div>
                  <div class="item-toggle">
                    <svg viewBox="0 0 24 24" fill="#000000">
                      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                  </div>
                </div>
              </div>
            </div>

            <div class="edit-section">
              <h3>Anything else you'd like to share?</h3>
              <div class="edit-items" id="custom-edit-items">
                <!-- Custom items will be added here dynamically -->
              </div>
              <div class="custom-input-section">
                <textarea 
                  id="custom-input-textarea" 
                  class="custom-input-textarea" 
                  placeholder="Add anything else you'd like to share with Alejandra..."></textarea>
                <button class="save-custom-btn" id="save-custom-btn">
                  <svg viewBox="0 0 24 24" width="24" height="24">
                    <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" stroke="#fff" fill="#fff" />
                  </svg>
                </button>
              </div>
            </div>
          </div>

          <!-- Original summary content (hidden by default)-->
          <div class="summary-content hidden" id="summary-content">
            <div class="content-section">
              <h3 class="section-title">Current Health Status</h3>
              <p class="section-text">Michelle has been experiencing consistent energy fluctuations throughout the day, particularly noticeable afternoon crashes around 2-3 PM. Recent lab work shows slightly elevated cholesterol and mild iron deficiency.</p>
              <ul class="section-list">
                <li>Afternoon energy crashes (2-3 PM daily)</li>
                <li>Elevated cholesterol levels (LDL: 145 mg/dL)</li>
                <li>Mild iron deficiency (ferritin: 18 ng/mL)</li>
                <li>Irregular sleep patterns affecting morning energy</li>
              </ul>
            </div>
            
            <div class="content-section">
              <h3 class="section-title">Dietary Patterns & Concerns</h3>
              <p class="section-text">Current eating habits include skipping breakfast 3-4 times per week, rushed lunches, and late dinners that are typically carb-heavy. Michelle tends to rely heavily on coffee for energy management.</p>
              <ul class="section-list">
                <li>Frequent breakfast skipping (3-4x per week)</li>
                <li>Rushed lunch breaks with processed foods</li>
                <li>Late dinners (after 8 PM) with high carb content</li>
                <li>Excessive caffeine consumption (4-5 cups daily)</li>
                <li>Stress-induced meal skipping patterns</li>
              </ul>
            </div>
            
            <div class="content-section">
              <h3 class="section-title">Goals for Upcoming Visit</h3>
              <p class="section-text">The primary focus will be addressing energy stability through improved meal timing and nutrient density. We'll also work on strategies for better meal planning despite a busy schedule.</p>
              <ul class="section-list">
                <li>Establish consistent breakfast routine with 20g+ protein</li>
                <li>Implement meal prep strategies for busy weekdays</li>
                <li>Address iron deficiency through dietary modifications</li>
                <li>Create sustainable evening meal timing</li>
                <li>Reduce caffeine dependency gradually</li>
              </ul>
            </div>
            
            <div class="content-section">
              <h3 class="section-title">Progress Since Last Visit</h3>
              <p class="section-text">Michelle has successfully implemented several recommendations from our previous session, including regular hydration tracking and incorporating more leafy greens into her diet.</p>
              <ul class="section-list">
                <li>Consistent water intake tracking (64+ oz daily)</li>
                <li>Added spinach/kale to smoothies 4x per week</li>
                <li>Reduced late-night snacking by 60%</li>
                <li>Started taking recommended vitamin D supplement</li>
                <li>Improved meal timing on weekends</li>
              </ul>
            </div>
          </div>

          <!-- Toggle button -->
          <div class="audit-button" id="pre-visit-action-btn">
            <div class="audit-button--manage">
              <span>Manage what you want to share</span>
              <svg viewBox="0 0 24 24" width="24" height="24">
                <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" fill="currentColor"/>
              </svg>
            </div>
            <div class="audit-button--see">
              <span>Update your pre-visit summary</span>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="Reward-Stars-2--Streamline-Ultimate" height="24" width="24">
                <desc>Reward Stars 2 Streamline Icon: https://streamlinehq.com</desc>
                <defs></defs>
                <path d="M10.751 1.375c-0.025 6.281 3.029 9.844 10 10 -6.465 -0.025 -9.672 3.441 -10 10 -0.063 -6.187 -2.828 -10.009 -10 -10 6.416 -0.09 9.975 -3.187 10 -10Z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
                <path d="m19.012 1.375 0 4" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
                <path d="m17.012 3.375 4 0" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
                <path d="m21.25 18.625 0 4" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
                <path d="m19.25 20.625 4 0" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
              </svg>
            </div>
          </div>

          <!-- Regenerating state (hidden by default) -->
          <div class="regenerating-state hidden" id="regenerating-state">
            <div class="regenerating-spinner"></div>
            <div class="regenerating-text">Regenerating pre-visit summary...</div>
            <div class="regenerating-subtext">This will take just a moment!</div>
          </div>
        </div>
      </div>
    </div>
    <!-- Unified text input popup for all goals -->
    <div class="text-input-popup" id="text-input-popup">
      <div class="popup-content">
          <div class="close-text-popup" id="close-text-popup">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M18 6L6 18" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M6 6L18 18" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="popup-header">
              <div class="popup-title">Share more about this goal.</div>
          </div>
          <div class="input-method-selector">
              <div class="input-method-option selected" data-method="type">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <span>Type</span>
              </div>
              <div class="input-method-option" data-method="speak">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M12 1C12 1 8 1 8 5V11C8 15 12 15 12 15C12 15 16 15 16 11V5C16 1 12 1 12 1Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M19 10V11C19 14.866 15.866 18 12 18C8.13401 18 5 14.866 5 11V10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <line x1="12" y1="18" x2="12" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <line x1="8" y1="23" x2="16" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <span>Speak</span>
              </div>
              <div class="input-method-option" data-method="upload">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                      <circle cx="8.5" cy="8.5" r="1.5" stroke="currentColor" stroke-width="2"/>
                      <polyline points="21,15 16,10 5,21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <span>Upload</span>
              </div>
          </div>
          <div class="text-input-container">
              <!-- Type input (default) -->
              <div class="input-area active" id="type-area">
                  <textarea class="main-textarea" placeholder="How did it go today? Share any details, challenges, or thoughts..."></textarea>
              </div>
              <!-- Speak input -->
              <div class="input-area hidden" id="speak-area">
                  <div class="speak-interface">
                      <button class="record-btn" id="record-btn">
                          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <circle cx="12" cy="12" r="3" fill="currentColor"/>
                          </svg>
                          Start Recording
                      </button>
                  </div>
              </div>
              <!-- Upload input -->
              <div class="input-area hidden" id="upload-area">
                  <div class="upload-interface">
                      <input type="file" id="file-input" accept="image/*" style="display: none;">
                      <button class="upload-btn" id="upload-btn">
                          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                              <polyline points="7,10 12,15 17,10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                              <line x1="12" y1="15" x2="12" y2="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                          </svg>
                          Choose Image
                      </button>
                  </div>
              </div>
          </div>
          <div class="text-input-footer">
              <button class="save-text-btn">Save</button>
          </div>
      </div>
    </div>
    <!-- Goals container for modals -->
    <div id="goals-modals-container">
      <!-- Goal modals will be generated by JavaScript -->
    </div>
  </body>
  <script>
    // Usage example - replace your original code with this:
      const goalsData = [
        {
          id: 1,
          title: "Say \"no\" to work treats.",
          ratingTransform: "poor" // no transform
        },
        {
          id: 2,
          title: "Drink 64oz of water a day.",
          ratingTransform: "poor" // no transform
        },
        {
          id: 3,
          title: "Exercise 15-20 min, 5 days per week.",
          ratingTransform: "OK" // rotate(-90)
        },
        {
          id: 4,
          title: "Avoid eating while watching TV.",
          ratingTransform: "good" // rotate(180)
        }
      ];
      const goalModalConfigs = generateGoalElements();
      const staticModalConfigs = [
        {
          openBtnSelector: '#ai-chat-btn',
          modalId: 'ai-chat',
          closeBtnId: 'ai-chat-close-btn'
        },
        {
          openBtnSelector: '#rd-chat-btn',
          modalId: 'rd-chat',
          closeBtnId: 'rd-chat-close-btn'
        },
        {
          openBtnSelector: '.appt-report-btn',
          modalId: 'appt-report',
          closeBtnId: 'appt-report-close-btn'
        },
        {
          openBtnSelector: '.pre-visit-summary-btn',
          modalId: 'pre-visit-summary',
          closeBtnId: 'pre-visit-summary-close-btn'
        }
      ];


    document.addEventListener('DOMContentLoaded', () => {
      

      initializeModals([...staticModalConfigs, ...goalModalConfigs]);
      initializeCardTimeline();
      initializeGoalCalendar();
      initializeBottomPanelClick();
      initializeAppointmentSoon();
      initializePreVisitSummaryEdit();
      initializeEditFormToggles(); 
      initializeCustomInput();
      initializeGoalLogging();
      initializeGoalAddMoreToggle();
      initializeUnifiedTextInput();
      initializeAppointmentReportTabs();
      updateAppointmentReportHeader();
    });

    window.addEventListener('scroll', () => {
      const winContainer = document.querySelector('.win-container');
      const bottomPanel = document.querySelector('.bottom-panel');
      
      if (!winContainer || !bottomPanel) return;
      
      const bottomPanelHeight = bottomPanel.offsetHeight;
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      
      // Calculate scroll progress based on bottom panel height
      const scrollProgress = Math.min(scrollTop / bottomPanelHeight, 1);
      
      // Calculate transform and opacity values for win-container
      const translateY = scrollProgress * -20; // Move up 20vh
      const opacity = 1 - (scrollProgress / 0.8); // Fade from 1 to 0 over first 70% of scroll
      
      // Apply the transformations
      winContainer.style.transform = `translateY(${translateY}vh)`;
      winContainer.style.opacity = opacity;
    });

    function enableHtmlScroll() {
      document.documentElement.classList.remove('no-scroll');
    }

    function disableHtmlScroll() {
      document.documentElement.classList.add('no-scroll');
    }

    function initializeCardTimeline() {
      const cardsContainer = document.getElementById('cards-container');
      const cards = document.querySelectorAll('.appointment-card');
      let currentIndex = 6; // Start with today card (index 6)
      let startX = 0;
      let isDragging = false;

      function updateCardPositions() {
        cards.forEach((card, index) => {
          card.classList.remove('left', 'center', 'right', 'hidden');
          
          if (index === currentIndex) {
            card.classList.add('center');
          } else if (index === currentIndex - 1) {
            card.classList.add('left');
          } else if (index === currentIndex + 1) {
            card.classList.add('right');
          } else {
            card.classList.add('hidden');
          }
        });
      }

      function addCardClickListeners() {
        cards.forEach((card, index) => {
          card.addEventListener('click', (e) => {
            // Only handle clicks on left and right cards
            if (card.classList.contains('left') || card.classList.contains('right')) {
              currentIndex = index;
              updateCardPositions();
              e.stopPropagation(); // Prevent event bubbling
            }
          });
        });
      }

      function swipeLeft() {
        if (currentIndex < cards.length - 1) {
          currentIndex++;
          updateCardPositions();
        }
      }

      function swipeRight() {
        if (currentIndex > 0) {
          currentIndex--;
          updateCardPositions();
        }
      }

      // Touch events
      cardsContainer.addEventListener('touchstart', (e) => {
        startX = e.touches[0].clientX;
        isDragging = true;
      });

      cardsContainer.addEventListener('touchmove', (e) => {
        if (!isDragging) return;
        e.preventDefault();
      });

      cardsContainer.addEventListener('touchend', (e) => {
        if (!isDragging) return;
        isDragging = false;
        
        const endX = e.changedTouches[0].clientX;
        const diff = startX - endX;
        
        if (Math.abs(diff) > 50) { // Minimum swipe distance
          if (diff > 0) {
            swipeLeft();
          } else {
            swipeRight();
          }
        }
      });

      // Mouse events for desktop
      cardsContainer.addEventListener('mousedown', (e) => {
        startX = e.clientX;
        isDragging = true;
      });

      cardsContainer.addEventListener('mousemove', (e) => {
        if (!isDragging) return;
        e.preventDefault();
      });

      cardsContainer.addEventListener('mouseup', (e) => {
        if (!isDragging) return;
        isDragging = false;
        
        const endX = e.clientX;
        const diff = startX - endX;
        
        if (Math.abs(diff) > 50) { // Minimum swipe distance
          if (diff > 0) {
            swipeLeft();
          } else {
            swipeRight();
          }
        }
      });

      updateCardPositions();
      addCardClickListeners();
    }

    function initializeModals(modalConfigs) {
      modalConfigs.forEach(config => setupModalToggle(config));
    }

    function setupModalToggle(config) {
      const { openBtnSelector, modalId, closeBtnId } = config;
      
      const openBtn = document.querySelectorAll(openBtnSelector);
      const modal = document.getElementById(modalId);
      const closeBtn = document.getElementById(closeBtnId);
      
      openBtn.forEach(btn => {
        btn.addEventListener('click', () => {
          modal.style.display = 'block';
          disableHtmlScroll();
        });
      });
      
      closeBtn.addEventListener('click', () => {
        modal.style.display = 'none';
        enableHtmlScroll();

      });
      
      // Close modal when clicking on the background (popup area)
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.style.display = 'none';
          enableHtmlScroll();
        }
      });
    }

    function toLocalDateOnly(date) {
      return new Date(date.getFullYear(), date.getMonth(), date.getDate());
    }

    function initializeGoalCalendar() {
      const calendar = document.getElementById('unified-goal-calendar');
      const today = new Date();
      const endDate = new Date('2025-08-29');
      const startDate = new Date('2025-07-21');
      let currentIndex = 0; // Will be set to today's index
      
      // Generate calendar days
      const days = [];
      let currentDate = toLocalDateOnly(startDate);
      const todayDate = toLocalDateOnly(new Date());

      while (currentDate <= endDate) {
        days.push(new Date(currentDate));
        currentDate.setDate(currentDate.getDate() + 1);
      }
      
      // Find today's index
      const todayIndex = days.findIndex(date => 
        date.toDateString() === todayDate.toDateString()
      );
      if (todayIndex !== -1) {
        currentIndex = todayIndex;
      }
      
      // Clear existing content
      calendar.innerHTML = '';
      
      // Render calendar days
      days.forEach((date, index) => {
        const dayElement = document.createElement('div');
        dayElement.className = 'calendar-day';
        dayElement.dataset.date = date.toISOString().split('T')[0];
        dayElement.dataset.index = index;
        
        const isToday = date.toDateString() === todayDate.toDateString();

        dayElement.innerHTML = `
          <div class="day-square ${isToday ? 'today' : ''}">
            <div class="check">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M5 12.7037L9.93103 18L18 5" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <div class="day-label">
              <div class="month">${date.toLocaleDateString('en-US', { month: 'short' })}</div>
              <div class="day">${date.getDate()}</div>
            </div>
          </div>
        `;
        
        calendar.appendChild(dayElement);
      });

      function updateCalendarPositions() {
        const dayElements = calendar.querySelectorAll('.calendar-day');
        
        dayElements.forEach((dayElement, index) => {
          const dayCircle = dayElement.querySelector('.day-square');
          dayCircle.classList.remove('selected');
          
          if (index === currentIndex) {
            dayCircle.classList.add('selected');
          }
        });
      }

      function centerSelectedDay() {
        const selectedDay = calendar.querySelector(`[data-index="${currentIndex}"]`);
        if (!selectedDay) return;

        const calendarRect = calendar.getBoundingClientRect();
        const selectedRect = selectedDay.getBoundingClientRect();
        
        // Calculate the offset of selected day relative to the calendar's scroll container
        const selectedOffsetLeft = selectedDay.offsetLeft;
        const selectedWidth = selectedRect.width;
        const calendarWidth = calendarRect.width;
        const maxScrollLeft = calendar.scrollWidth - calendar.clientWidth;
        
        // Calculate ideal scroll position to center the selected day
        let scrollToCenter = selectedOffsetLeft - (calendarWidth / 2) + (selectedWidth / 2);
        
        // Clamp the scroll position to valid bounds
        scrollToCenter = Math.max(0, Math.min(scrollToCenter, maxScrollLeft));
        
        // Smooth scroll to the position
        calendar.scrollTo({
          left: scrollToCenter,
          behavior: 'smooth'
        });
      }

      function addCalendarClickListeners() {
        const dayElements = calendar.querySelectorAll('.calendar-day');
        
        dayElements.forEach((dayElement, index) => {
          dayElement.addEventListener('click', (e) => {
            // Prevent click if we were just scrolling/swiping
            if (calendar.dataset.wasScrolling === 'true') {
              return;
            }
            
            currentIndex = index;
            updateCalendarPositions();
            
            // Center the newly selected day
            setTimeout(() => {
              centerSelectedDay();
            }, 50); // Small delay to ensure DOM updates
            
            e.stopPropagation();
          });
        });
      }

      // Track scrolling state to prevent clicks during scroll
      let scrollTimeout;
      let isScrolling = false;

      calendar.addEventListener('scroll', () => {
        isScrolling = true;
        calendar.dataset.wasScrolling = 'true';
        
        clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(() => {
          isScrolling = false;
          calendar.dataset.wasScrolling = 'false';
        }, 150);
      });

      // Touch events for free scrolling (no selection change)
      let startX = 0;
      let startY = 0;
      let isDragging = false;

      calendar.addEventListener('touchstart', (e) => {
        startX = e.touches[0].clientX;
        startY = e.touches[0].clientY;
        isDragging = false;
      });

      calendar.addEventListener('touchmove', (e) => {
        const currentX = e.touches[0].clientX;
        const currentY = e.touches[0].clientY;
        const diffX = Math.abs(currentX - startX);
        const diffY = Math.abs(currentY - startY);
        
        // If horizontal movement is greater than vertical, we're scrolling horizontally
        if (diffX > diffY && diffX > 10) {
          isDragging = true;
          calendar.dataset.wasScrolling = 'true';
        }
      });

      calendar.addEventListener('touchend', (e) => {
        if (isDragging) {
          // Reset scrolling state after a delay
          setTimeout(() => {
            calendar.dataset.wasScrolling = 'false';
          }, 100);
        }
        isDragging = false;
      });

      // Mouse events for desktop (free scrolling)
      calendar.addEventListener('mousedown', (e) => {
        startX = e.clientX;
        isDragging = false;
      });

      calendar.addEventListener('mousemove', (e) => {
        const currentX = e.clientX;
        const diffX = Math.abs(currentX - startX);
        
        if (diffX > 10) {
          isDragging = true;
          calendar.dataset.wasScrolling = 'true';
        }
      });

      calendar.addEventListener('mouseup', (e) => {
        if (isDragging) {
          // Reset scrolling state after a delay
          setTimeout(() => {
            calendar.dataset.wasScrolling = 'false';
          }, 100);
        }
        isDragging = false;
      });

      // Initialize
      calendar.dataset.wasScrolling = 'false';
      updateCalendarPositions();
      addCalendarClickListeners();
      
      // Center today on load
      setTimeout(() => {
        centerSelectedDay();
      }, 100);
    }

    function initializeBottomPanelClick() {
      const bottomPanelHeader = document.querySelector('.bottom-panel-header');
              
      if (bottomPanelHeader) {
        bottomPanelHeader.addEventListener('click', () => {
            // Add bounce animation class
            bottomPanelHeader.classList.add('bounce-animation');
            
            // Remove the animation class after animation completes
            setTimeout(() => {
                bottomPanelHeader.classList.remove('bounce-animation');
            }, 500);
            
            window.scrollTo({
                top: document.documentElement.scrollHeight,
                behavior: 'smooth'
            });
        });
      }
    }

    function initializeAppointmentSoon() {
      const noThanksBtn = document.querySelector('.no-thanks-btn');
      const aptSoonModal = document.querySelector('.apt-soon--modal');
      const aptSoonShort = document.querySelector('.apt-soon--short');
      const aptSoonShortCtaBtn = document.querySelector('.apt-soon--short .cta-btn');
      
      noThanksBtn.addEventListener('click', (e) => {
        e.preventDefault();
        aptSoonModal.classList.add('hidden');
        aptSoonShort.classList.remove('hidden');
      });

      aptSoonShortCtaBtn.addEventListener('click', (e) => {
        e.preventDefault();
        aptSoonShort.classList.add('hidden');
      });
    }

    function initializePreVisitSummaryEdit() {
      const actionBtn = document.getElementById('pre-visit-action-btn');
      const summaryContent = document.getElementById('summary-content');
      const editForm = document.getElementById('edit-form');
      const regeneratingState = document.getElementById('regenerating-state');
      const actionBtnManage = document.querySelector('.audit-button--manage');
      const actionBtnSee = document.querySelector('.audit-button--see');
      
      let isEditing = true;
      updateActionButtonText();
    
      actionBtn.addEventListener('click', () => {
        if (isEditing) {
          saveAndRegenerate();
        } else {
          switchToEditMode();
        }
      });
    
      function switchToEditMode() {
        summaryContent.classList.add('hidden');
        editForm.classList.remove('hidden');
        isEditing = true;
        updateActionButtonText();
      }
      
      function saveAndRegenerate() {
        editForm.classList.add('hidden');
        actionBtn.classList.add('hidden');
        regeneratingState.classList.remove('hidden');
        
        // Simulate regeneration process (modify when implementing into React)
        setTimeout(() => {
          // Hide regenerating state
          summaryContent.classList.remove('hidden');
          actionBtn.classList.remove('hidden');
          regeneratingState.classList.add('hidden');
          isEditing = false;
          updateActionButtonText();
        }, 1000);
      }

      function updateActionButtonText() {
        if (isEditing) {
          actionBtnSee.classList.remove('hidden');
          actionBtnManage.classList.add('hidden');
        } else {
          actionBtnManage.classList.remove('hidden');
          actionBtnSee.classList.add('hidden');
        }
      }
    }

    function initializeEditFormToggles() {
      const editItems = document.querySelectorAll('.edit-form .edit-item');
      const actionBtn = document.getElementById('pre-visit-action-btn');
      
      editItems.forEach(item => {
        item.addEventListener('click', () => {
          const toggle = item.querySelector('.item-toggle');
          const isExcluded = item.classList.contains('excluded');

          actionBtn.classList.remove('hidden');
          
          if (isExcluded) {
            // Switch back to checkmark
            item.classList.remove('excluded');
            toggle.classList.remove('excluded');
            toggle.innerHTML = `
              <svg viewBox="0 0 24 24">
                <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
              </svg>
            `;
          } else {
            // Switch to X
            item.classList.add('excluded');
            toggle.classList.add('excluded');
            toggle.innerHTML = '';
          }
        });
      });
    }

    function initializeCustomInput() {
      const saveBtn = document.getElementById('save-custom-btn');
      const textarea = document.getElementById('custom-input-textarea');
      const customItemsContainer = document.getElementById('custom-edit-items');
      
      saveBtn.addEventListener('click', () => {
        const inputText = textarea.value.trim();
        
        if (inputText) {
          // Create new edit item
          const newItem = document.createElement('div');
          newItem.className = 'edit-item';
          newItem.dataset.itemId = `custom-${Date.now()}`;
          
          newItem.innerHTML = `
            <div class="item-text">${inputText}</div>
            <div class="item-toggle">
              <svg viewBox="0 0 24 24">
                <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
              </svg>
            </div>
          `;
          
          // Add click handler for the new item
          newItem.addEventListener('click', () => {
            const toggle = newItem.querySelector('.item-toggle');
            const isExcluded = newItem.classList.contains('excluded');
            
            if (isExcluded) {
              newItem.classList.remove('excluded');
              toggle.classList.remove('excluded');
              toggle.innerHTML = `
                <svg viewBox="0 0 24 24">
                  <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                </svg>
              `;
            } else {
              newItem.classList.add('excluded');
              toggle.classList.add('excluded');
              toggle.innerHTML = '';
            }
          });
          
          customItemsContainer.appendChild(newItem);
          textarea.value = '';
          textarea.focus();
        }
      });
    }

    function initializeGoalLogging() {
      document.querySelectorAll('.input-option').forEach(option => {
        option.addEventListener('click', function() {
          const goalId = this.closest('.popup-content').id.split('-')[1];
          const inputType = this.dataset.type;
        });
      });
    }

    function generateGoalElements() {
      const modalConfigs = [];
      
      // Generate goal modals
      const goalsModalsContainer = document.getElementById('goals-modals-container');
      const goalsContainer = document.getElementById('goals-container');
      
      // Clear existing content
      goalsModalsContainer.innerHTML = '';
      goalsContainer.innerHTML = '';
      
      goalsData.forEach(goal => {
        // Create and append goal modal
        const modalElement = document.createElement('div');
        modalElement.innerHTML = createGoalModalTemplate(goal);
        goalsModalsContainer.appendChild(modalElement.firstElementChild);
        
        // Create and append bottom panel square
        const squareElement = document.createElement('div');
        squareElement.innerHTML = createBottomPanelSquareTemplate(goal);
        goalsContainer.appendChild(squareElement.firstElementChild);
        
        // Add to modal configs for initialization
        modalConfigs.push({
          openBtnSelector: `.goals-${goal.id}-logging-btn`,
          modalId: `goals-${goal.id}-logging`,
          closeBtnId: `goals-${goal.id}-logging-close-btn`
        });
      });
      
      return modalConfigs;
    }

    function getTransformForRating(ratingTransform) {
      switch(ratingTransform) {
        case "OK":
          return "rotate(-90)";
        case "good":
          return "rotate(180)";
        default:
          return "";
      }
    }

    function createBottomPanelSquareTemplate(goal) {
      const transform = getTransformForRating(goal.ratingTransform);
      
      return `
        <div class="bottom-panel-square square square-${goal.id} goals-${goal.id}-logging-btn">
          <div class="rated">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"${transform ? ` transform="${transform}"` : ''}>
              <path d="M7 22H4C3.46957 22 2.96086 21.7893 2.58579 21.4142C2.21071 21.0391 2 20.5304 2 20V13C2 12.4696 2.21071 11.9609 2.58579 11.5858C2.96086 11.2107 3.46957 11 4 11H7M14 9V5C14 4.20435 13.6839 3.44129 13.1213 2.87868C12.5587 2.31607 11.7956 2 11 2L7 11V22H18.28C18.7623 22.0055 19.2304 21.8364 19.5979 21.524C19.9654 21.2116 20.2077 20.7769 20.28 20.3L21.66 11.3C21.7035 11.0134 21.6842 10.7207 21.6033 10.4423C21.5225 10.1638 21.3821 9.90629 21.1919 9.68751C21.0016 9.46873 20.7661 9.29393 20.5016 9.17522C20.2371 9.0565 19.9499 8.99672 19.66 9H14Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <span>${goal.title}</span>
        </div>
      `;
    }

    function createGoalModalTemplate(goal) {
      return `
        <div class="popup" id="goals-${goal.id}-logging">
          <div class="popup-content goals-${goal.id}-logging">
            <div class="close" id="goals-${goal.id}-logging-close-btn">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M18 6L6 18" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M6 6L18 18" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div> 
            <div class="goal-title">${goal.title}</div>
            <div class="goal-rating">
              <div class="day-square today">
                <div class="day-label">
                  <div class="month">Aug</div>
                  <div class="day">25</div>
                </div>
              </div>
              <div class="goal-rating-title">How did it go today?</div>
              <div class="rating-options">
                <div class="rating-option">
                  <div class="rating-btn" data-rating="positive">
                    <span>I didn't do so well.</span>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M7 22H4C3.46957 22 2.96086 21.7893 2.58579 21.4142C2.21071 21.0391 2 20.5304 2 20V13C2 12.4696 2.21071 11.9609 2.58579 11.5858C2.96086 11.2107 3.46957 11 4 11H7M14 9V5C14 4.20435 13.6839 3.44129 13.1213 2.87868C12.5587 2.31607 11.7956 2 11 2L7 11V22H18.28C18.7623 22.0055 19.2304 21.8364 19.5979 21.524C19.9654 21.2116 20.2077 20.7769 20.28 20.3L21.66 11.3C21.7035 11.0134 21.6842 10.7207 21.6033 10.4423C21.5225 10.1638 21.3821 9.90629 21.1919 9.68751C21.0016 9.46873 20.7661 9.29393 20.5016 9.17522C20.2371 9.0565 19.9499 8.99672 19.66 9H14Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </div>
                </div>
                <div class="rating-option">
                  <div class="rating-btn" data-rating="neutral">
                    <span>I did OK.</span>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" transform="rotate(-90)">
                      <path d="M7 22H4C3.46957 22 2.96086 21.7893 2.58579 21.4142C2.21071 21.0391 2 20.5304 2 20V13C2 12.4696 2.21071 11.9609 2.58579 11.5858C2.96086 11.2107 3.46957 11 4 11H7M14 9V5C14 4.20435 13.6839 3.44129 13.1213 2.87868C12.5587 2.31607 11.7956 2 11 2L7 11V22H18.28C18.7623 22.0055 19.2304 21.8364 19.5979 21.524C19.9654 21.2116 20.2077 20.7769 20.28 20.3L21.66 11.3C21.7035 11.0134 21.6842 10.7207 21.6033 10.4423C21.5225 10.1638 21.3821 9.90629 21.1919 9.68751C21.0016 9.46873 20.7661 9.29393 20.5016 9.17522C20.2371 9.0565 19.9499 8.99672 19.66 9H14Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </div>
                </div>
                <div class="rating-option">
                  <div class="rating-btn" data-rating="negative">
                    <span>I did great!</span>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" transform="rotate(180)">
                      <path d="M7 22H4C3.46957 22 2.96086 21.7893 2.58579 21.4142C2.21071 21.0391 2 20.5304 2 20V13C2 12.4696 2.21071 11.9609 2.58579 11.5858C2.96086 11.2107 3.46957 11 4 11H7M14 9V5C14 4.20435 13.6839 3.44129 13.1213 2.87868C12.5587 2.31607 11.7956 2 11 2L7 11V22H18.28C18.7623 22.0055 19.2304 21.8364 19.5979 21.524C19.9654 21.2116 20.2077 20.7769 20.28 20.3L21.66 11.3C21.7035 11.0134 21.6842 10.7207 21.6033 10.4423C21.5225 10.1638 21.3821 9.90629 21.1919 9.68751C21.0016 9.46873 20.7661 9.29393 20.5016 9.17522C20.2371 9.0565 19.9499 8.99672 19.66 9H14Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </div>
                </div>
              </div>
              <div class="goal-action-buttons hidden">
                <button class="share-more-btn" data-goal="${goal.id}">Share More&hellip;</button>
                <span class="button-divider">or</span>
                <button class="save-btn" data-goal="${goal.id}">Save</button>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function initializeGoalAddMoreToggle() {
      // Hide all goal-add-more sections by default
      document.querySelectorAll('.goal-action-buttons').forEach(section => {
        section.classList.add('hidden');
      });

      // Add event listeners to all rating options
      document.querySelectorAll('.rating-btn').forEach(option => {
        option.addEventListener('click', function() {
          const parentGoal = this.closest('.popup-content');
          if (!parentGoal) return;

          const goalAddMoreSection = parentGoal.querySelector('.goal-action-buttons');
          
          // Remove selected class from all rating options in this goal
          parentGoal.querySelectorAll('.rating-btn').forEach(opt => {
            opt.classList.remove('selected');
          });
          
          // Add selected class to clicked option
          this.classList.add('selected');
          
          // Show the goal-add-more section with a smooth animation
          if (goalAddMoreSection) {
            goalAddMoreSection.classList.remove('hidden')
            goalAddMoreSection.style.opacity = '0';
            goalAddMoreSection.style.transform = 'translateY(20px)';
            
            // Animate in
            requestAnimationFrame(() => {
              goalAddMoreSection.style.transition = 'all 0.3s ease';
              goalAddMoreSection.style.opacity = '1';
              goalAddMoreSection.style.transform = 'translateY(0)';
            });
          }
        });
      });

      // Add event listeners to all rating options
      document.querySelectorAll('.input-option').forEach(option => {
        option.addEventListener('click', function() {
          const parentGoal = this.closest('.popup-content');
          if (!parentGoal) return;

          // Remove selected class from all rating options in this goal
          parentGoal.querySelectorAll('.input-option').forEach(opt => {
            opt.classList.remove('selected');
          });
          
          // Add selected class to clicked option
          this.classList.add('selected');
        });
      });
    }

    function initializeUnifiedTextInput() {
      const textInputPopup = document.getElementById('text-input-popup');
      const closeBtn = document.getElementById('close-text-popup');
      const saveBtn = textInputPopup.querySelector('.save-text-btn');
      const textarea = textInputPopup.querySelector('.main-textarea');
      
      let currentGoalId = null;

      // Store reference to current goal when opening popup
      document.querySelectorAll('.share-more-btn').forEach(button => {
          button.addEventListener('click', (e) => {
              currentGoalId = e.target.dataset.goal;
              textInputPopup.style.display = 'flex';
              
              // Focus on textarea after a short delay
              setTimeout(() => {
                  textarea.focus();
              }, 300);
          });
      });

      // Handle input method selector for text input popup
      document.querySelectorAll('.input-method-option').forEach(option => {
          option.addEventListener('click', (e) => {
              const method = e.currentTarget.dataset.method;
              const popup = e.currentTarget.closest('.text-input-popup');
              
              // Remove selected class from all options in this popup
              popup.querySelectorAll('.input-method-option').forEach(opt => {
                  opt.classList.remove('selected');
              });
              
              // Add selected class to clicked option
              e.currentTarget.classList.add('selected');
              
              // Hide all input areas in this popup
              popup.querySelectorAll('.input-area').forEach(area => {
                  area.classList.add('hidden');
              });
              
              // Show the selected input area
              const targetArea = popup.querySelector(`#${method}-area`);
              if (targetArea) {
                  targetArea.classList.remove('hidden');
                  
                  // Focus on textarea if type method is selected
                  if (method === 'type') {
                      const textarea = targetArea.querySelector('.main-textarea');
                      if (textarea) {
                          setTimeout(() => textarea.focus(), 100);
                      }
                  }
              }
          });
      });

     // Handle Save buttons (same functionality as old goal-footer button)
      document.querySelectorAll('.save-btn').forEach(button => {
        button.addEventListener('click', (e) => {
          const goalId = e.target.dataset.goal;
          const modal = document.getElementById(`goals-${goalId}-logging`);
          
          // In a real app, you'd save the data here
          console.log(`Saving goal ${goalId} without additional text`);
          
          // Hide modal
          modal.style.display = 'none';
          enableHtmlScroll();
        });
      });

      // Close text input popup
      if (closeBtn) {
          closeBtn.addEventListener('click', () => {
              textInputPopup.style.display = 'none';
              currentGoalId = null;
          });
      }

      // Close when clicking background
      textInputPopup.addEventListener('click', (e) => {
          if (e.target === textInputPopup) {
              textInputPopup.style.display = 'none';
              currentGoalId = null;
          }
      });

      // Save and close both popups
      if (saveBtn) {
          saveBtn.addEventListener('click', () => {
              const textContent = textarea.value.trim();
              
              // In a real app, you'd save the data here
              console.log(`Saving text input for goal ${currentGoalId}:`, textContent);
              
              // Hide text input popup
              textInputPopup.style.display = 'none';
              
              // Hide parent goal popup if currentGoalId exists
              if (currentGoalId) {
                  const parentPopup = document.getElementById(`goals-${currentGoalId}-logging`);
                  if (parentPopup) {
                      parentPopup.style.display = 'none';
                  }
              }
              
              // Re-enable scrolling
              enableHtmlScroll();
              
              // Clear textarea and reset goal reference
              textarea.value = '';
              currentGoalId = null;
          });
      }
    }

    function initializeAppointmentReportTabs() {
      const tabBtns = document.querySelectorAll('.appt-report-tabs .tab-btn');
      const tabContents = document.querySelectorAll('.tab-content');

      tabBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          const targetTab = btn.dataset.tab;
          
          // Remove active class from all tabs and content
          tabBtns.forEach(b => b.classList.remove('active'));
          tabContents.forEach(c => c.classList.remove('active'));
          
          // Add active class to clicked tab
          btn.classList.add('active');
          
          // Show corresponding content
          const targetContent = document.getElementById(`${targetTab}-content`);
          if (targetContent) {
            targetContent.classList.add('active');
          }
        });
      });
    }

    function updateAppointmentReportHeader() {
      document.querySelectorAll('.appt-report-btn').forEach((btn, index) => {
        btn.addEventListener('click', () => {
          const card = btn.closest('.appointment-card');
          const appointmentDate = card.dataset.appointmentDate;
          const appointmentIndex = parseInt(card.dataset.index);
          
          // Get the previous appointment date for date range
          const cards = document.querySelectorAll('.appointment-card');
          let headerText = '';
          
          if (appointmentIndex === 0) {
            // First appointment, just show single date
            const date = new Date(appointmentDate);
            headerText = date.toLocaleDateString('en-US', { month: 'numeric', day: 'numeric' }) + ' Summary';
          } else {
            // Find previous appointment
            const prevCard = Array.from(cards).find(c => parseInt(c.dataset.index) === appointmentIndex - 1);
            if (prevCard) {
              const prevDate = new Date(prevCard.dataset.appointmentDate);
              const currentDate = new Date(appointmentDate);
              
              const prevFormatted = prevDate.toLocaleDateString('en-US', { month: 'numeric', day: 'numeric' });
              const currentFormatted = currentDate.toLocaleDateString('en-US', { month: 'numeric', day: 'numeric' });
              
              headerText = `${prevFormatted} - ${currentFormatted} Summary`;
            } else {
              // Fallback to single date
              const date = new Date(appointmentDate);
              headerText = date.toLocaleDateString('en-US', { month: 'numeric', day: 'numeric' }) + ' Summary';
            }
          }
          
          // Update the header
          const header = document.getElementById('appt-report-header');
          if (header) {
            header.textContent = headerText;
          }
        });
      });
    }


  </script>
</html>